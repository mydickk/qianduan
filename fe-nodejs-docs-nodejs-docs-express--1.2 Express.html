<!DOCTYPE html> <html lang="en-US"><!--
 Page saved with SingleFile 
 url: https://interview2.poetries.top/fe-nodejs-docs/nodejs-docs/express/-1.2 Express.html 
 saved date: Wed Aug 24 2022 14:03:35 GMT+0800 (China Standard Time)
--><head>
      <style type="text/css">
        @media screen and (min-width:850px){
          .sidebar-button{
            display: none
          }
          .sidebar{
            transform: translateX(0);
          }
        }
        @media screen and (max-width:850px){
          .sidebar-button{
            display: block
          }
        }
      </style>
      <script>
      document.onreadystatechange=function() {
        if(document.readyState == "complete"){ //当页面加载状态为完全结束时进入
          const sidebar = document.querySelector(".sidebar");
          document.querySelector(".sidebar-button").addEventListener("click", (e) => {
            if (!sidebar.style.transform || sidebar.style.transform === "translateX(-100%)") {
              sidebar.style.transform = "translateX(0)";
            } else {
              sidebar.style.transform = "translateX(-100%)";
            }
          });
          var throttle = function (func, delay) {
            var prev = Date.now();
            return function () {
              var context = this; //this指向window
              var args = arguments;
              var now = Date.now();
              if (now - prev >= delay) {
                func.apply(context, args);
                prev = Date.now();
              }
            };
          };
          window.onresize = throttle(function () {
            if (window.innerWidth > 850) {
              if (!sidebar.style.transform || sidebar.style.transform === "translateX(-100%)") {
                sidebar.style.transform = "translateX(0)";
              }
            }
          }, 1000);
        }
      }
      </script><meta charset="utf-8">
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Express 基础应用 | Node学习指南</title>
    
    
  
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
  <meta name="apple-mobile-web-app-status-bar-style">
  
    
    
    <style>svg[data-v-49140617]{position:absolute;right:7.5px;cursor:pointer}svg.hover[data-v-49140617]{opacity:0}svg[data-v-49140617]:hover{opacity:1!important}span[data-v-49140617]{position:absolute;font-size:.85rem;line-height:.425rem;right:50px;opacity:0;-webkit-transition:opacity .5s;transition:opacity .5s}.code-copy-added:hover>.code-copy svg{opacity:.75}@-webkit-keyframes rotating{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes rotating{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes v-modal-in{0%{opacity:0}}@-webkit-keyframes v-modal-out{to{opacity:0}}.el-dialog__wrapper{position:fixed;top:0;right:0;bottom:0;left:0;overflow:auto;margin:0}@-webkit-keyframes dialog-fade-in{0%{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@keyframes dialog-fade-in{0%{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@-webkit-keyframes dialog-fade-out{0%{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}to{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}}@keyframes dialog-fade-out{0%{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}to{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}}@keyframes v-modal-in{0%{opacity:0}}@keyframes v-modal-out{to{opacity:0}}@-webkit-keyframes msgbox-fade-in{0%{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@keyframes msgbox-fade-in{0%{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@-webkit-keyframes msgbox-fade-out{0%{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}to{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}}@keyframes msgbox-fade-out{0%{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}to{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}}@-webkit-keyframes slideInRight-enter{0%{opacity:0;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(100%);transform:translateX(100%)}to{opacity:1;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInRight-enter{0%{opacity:0;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(100%);transform:translateX(100%)}to{opacity:1;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes slideInRight-leave{0%{-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(0);transform:translateX(0);opacity:1}to{-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(100%);transform:translateX(100%);opacity:0}}@keyframes slideInRight-leave{0%{-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(0);transform:translateX(0);opacity:1}to{-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(100%);transform:translateX(100%);opacity:0}}@-webkit-keyframes slideInLeft-enter{0%{opacity:0;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(-100%);transform:translateX(-100%)}to{opacity:1;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInLeft-enter{0%{opacity:0;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(-100%);transform:translateX(-100%)}to{opacity:1;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes slideInLeft-leave{0%{-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(0);transform:translateX(0);opacity:1}to{-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(-100%);transform:translateX(-100%);opacity:0}}@keyframes slideInLeft-leave{0%{-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(0);transform:translateX(0);opacity:1}to{-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:translateX(-100%);transform:translateX(-100%);opacity:0}}@-webkit-keyframes loading-rotate{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes loading-rotate{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes loading-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40px}to{stroke-dasharray:90,150;stroke-dashoffset:-120px}}@keyframes loading-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40px}to{stroke-dasharray:90,150;stroke-dashoffset:-120px}}@-webkit-keyframes progress{0%{background-position:0 0}to{background-position:32px 0}}@keyframes progress{0%{background-position:0 0}to{background-position:32px 0}}@-webkit-keyframes rotate{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes rotate{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@-webkit-keyframes dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}to{stroke-dasharray:90,150;stroke-dashoffset:-124}}@keyframes dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}to{stroke-dasharray:90,150;stroke-dashoffset:-124}}@-webkit-keyframes viewer-fade-in{0%{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@keyframes viewer-fade-in{0%{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}to{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}}@-webkit-keyframes viewer-fade-out{0%{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}to{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}}@keyframes viewer-fade-out{0%{-webkit-transform:translateZ(0);transform:translateZ(0);opacity:1}to{-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0);opacity:0}}@-webkit-keyframes el-drawer-fade-in{0%{opacity:0}to{opacity:1}}@keyframes el-drawer-fade-in{0%{opacity:0}to{opacity:1}}@-webkit-keyframes rtl-drawer-in{0%{-webkit-transform:translate(100%);transform:translate(100%)}to{-webkit-transform:translate(0);transform:translate(0)}}@keyframes rtl-drawer-in{0%{-webkit-transform:translate(100%);transform:translate(100%)}to{-webkit-transform:translate(0);transform:translate(0)}}@-webkit-keyframes rtl-drawer-out{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translate(100%);transform:translate(100%)}}@keyframes rtl-drawer-out{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translate(100%);transform:translate(100%)}}@-webkit-keyframes ltr-drawer-in{0%{-webkit-transform:translate(-100%);transform:translate(-100%)}to{-webkit-transform:translate(0);transform:translate(0)}}@keyframes ltr-drawer-in{0%{-webkit-transform:translate(-100%);transform:translate(-100%)}to{-webkit-transform:translate(0);transform:translate(0)}}@-webkit-keyframes ltr-drawer-out{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translate(-100%);transform:translate(-100%)}}@keyframes ltr-drawer-out{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translate(-100%);transform:translate(-100%)}}@-webkit-keyframes ttb-drawer-in{0%{-webkit-transform:translateY(-100%);transform:translateY(-100%)}to{-webkit-transform:translate(0);transform:translate(0)}}@keyframes ttb-drawer-in{0%{-webkit-transform:translateY(-100%);transform:translateY(-100%)}to{-webkit-transform:translate(0);transform:translate(0)}}@-webkit-keyframes ttb-drawer-out{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translateY(-100%);transform:translateY(-100%)}}@keyframes ttb-drawer-out{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translateY(-100%);transform:translateY(-100%)}}@-webkit-keyframes btt-drawer-in{0%{-webkit-transform:translateY(100%);transform:translateY(100%)}to{-webkit-transform:translate(0);transform:translate(0)}}@keyframes btt-drawer-in{0%{-webkit-transform:translateY(100%);transform:translateY(100%)}to{-webkit-transform:translate(0);transform:translate(0)}}@-webkit-keyframes btt-drawer-out{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translateY(100%);transform:translateY(100%)}}@keyframes btt-drawer-out{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translateY(100%);transform:translateY(100%)}}@-webkit-keyframes nprogress-spinner{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes nprogress-spinner{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.icon.outbound{color:#aaa;display:inline-block;vertical-align:middle;position:relative;top:-1px}.nav-links{display:inline-block}.nav-links a{line-height:1.4rem;color:inherit}.nav-links a.router-link-active,.nav-links a:hover{color:#3eaf7c}.nav-links .nav-item{position:relative;display:inline-block;margin-left:1.5rem;line-height:2rem}.nav-links .nav-item:first-child{margin-left:0}@media (max-width:850px){.nav-links .nav-item{margin-left:0}}@media (min-width:850px){.nav-links a.router-link-active,.nav-links a:hover{color:#2c3e50}}.navbar{padding:.7rem 1.5rem;line-height:2.2rem}.navbar a{display:inline-block}.navbar .links{padding-left:1.5rem;box-sizing:border-box;background-color:#fff;white-space:nowrap;font-size:.9rem;position:absolute;right:1.5rem;top:.7rem;display:-webkit-box;display:flex}@media (max-width:850px){.navbar{padding-left:4rem}.navbar .can-hide{display:none}.navbar .links{padding-left:1.5rem}}.page-nav{max-width:740px;margin:0 auto;padding:2rem 2.5rem}@media (max-width:959px){.page-nav{padding:2rem}}@media (max-width:419px){.page-nav{padding:1.5rem}}.page-nav{padding-top:1rem;padding-bottom:0}.page-nav .inner{min-height:2rem;margin-top:0;border-top:1px solid #eaecef;padding-top:1rem;overflow:auto}.page-nav .next{float:right}.page{padding-bottom:2rem;overflow-x:hidden;display:block}@media only screen and (min-device-width:768px) and (max-device-width:1024px){.page{padding-bottom:20rem!important}}@media screen and (min-width:1200px){.theme-default-content:not(.custom){max-width:1300px!important}}.theme-default-content .content__default{position:relative}.theme-default-content .content__default pre{position:relative!important;padding-top:40px!important}.theme-default-content .content__default pre:after{content:"";position:absolute;top:9px;left:12px;z-index:1;width:10px;height:10px;border-radius:50%;background:#fc625d;box-shadow:20px 0#fdbc40,40px 0#35cd4b}@media screen and (min-width:700px){.theme-default-content .content__default h2{display:-webkit-inline-box;display:inline-flex;-webkit-box-align:center;align-items:center;font-weight:700;background:#ef7060;color:#fff;padding:3px 10px 4px;border-top-right-radius:3px;border-top-left-radius:3px;margin-right:3px;font-size:20px}.theme-default-content .content__default h2:after{content:"";display:inline-block;vertical-align:bottom;border-bottom:36px solid #efebe9;border-right:20px solid transparent;position:relative;left:32px;top:1px}.theme-default-content .content__default h2:before{content:"";border-bottom:2px solid #ef7060;width:100%;display:block;height:10px;position:absolute;margin-top:32px}}.theme-default-content .content__default code{color:#c7254e;background-color:#f9f2f4;font-size:14px;border-radius:5px;padding-left:5px;padding-right:5px;margin:auto 3px}.theme-default-content .content__default blockquote{padding:2px 16px;color:#555;border-left:5px solid #ef7060;background:#fff9f9;font-size:1rem}@-webkit-keyframes upDown{0%{-webkit-transform:translateY(5px);transform:translateY(5px)}25%{-webkit-transform:translateY(0);transform:translateY(0)}50%{-webkit-transform:translateY(5px);transform:translateY(5px)}75%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(5px);transform:translateY(5px)}}@keyframes upDown{0%{-webkit-transform:translateY(5px);transform:translateY(5px)}25%{-webkit-transform:translateY(0);transform:translateY(0)}50%{-webkit-transform:translateY(5px);transform:translateY(5px)}75%{-webkit-transform:translateY(0);transform:translateY(0)}to{-webkit-transform:translateY(5px);transform:translateY(5px)}}.sidebar-group:not(.collapsable) .sidebar-heading:not(.clickable){cursor:auto;color:inherit}.sidebar-heading{color:#2c3e50;-webkit-transition:color .15s ease;transition:color .15s ease;cursor:pointer;font-size:1.1em;font-weight:700;padding:.35rem 1.5rem .35rem 1.25rem;width:100%;box-sizing:border-box;margin:0;border-left:.25rem solid transparent}.sidebar-heading.open,.sidebar-heading:hover{color:inherit}.sidebar-group-items{-webkit-transition:height .1s ease-out;transition:height .1s ease-out;font-size:.95em;overflow:hidden}.sidebar .sidebar-sub-headers{padding-left:1rem;font-size:.95em}a.sidebar-link{font-size:1em;font-weight:400;color:#2c3e50;border-left:.25rem solid transparent;padding:.35rem 1rem .35rem 1.25rem;line-height:1.4;width:100%;box-sizing:border-box}a.sidebar-link:hover{color:#3eaf7c}a.sidebar-link.active{font-weight:600;color:#3eaf7c;border-left-color:#3eaf7c}.sidebar-group a.sidebar-link{padding-left:2rem}.sidebar-sub-headers a.sidebar-link{padding-top:.25rem;padding-bottom:.25rem;border-left:none}.sidebar-sub-headers a.sidebar-link.active{font-weight:500}.sidebar ul{padding:0;margin:0;list-style-type:none}.sidebar a{display:inline-block}.sidebar>.sidebar-links{padding:1.5rem 0}.sidebar>.sidebar-links>li:not(:first-child){margin-top:.75rem}@media (max-width:850px){.sidebar>.sidebar-links{padding:1rem 0}}@-webkit-keyframes move{0%{-webkit-transform:translate(-175px) scale(1);transform:translate(-175px) scale(1)}50%{-webkit-transform:translate(-87px) scaleY(.5);transform:translate(-87px) scaleY(.5)}to{-webkit-transform:translate(0) scale(1);transform:translate(0) scale(1)}}@keyframes move{0%{-webkit-transform:translate(-175px) scale(1);transform:translate(-175px) scale(1)}50%{-webkit-transform:translate(-87px) scaleY(.5);transform:translate(-87px) scaleY(.5)}to{-webkit-transform:translate(0) scale(1);transform:translate(0) scale(1)}}.posr{position:relative}pre[class*=language-]{color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.token.comment{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.tag{color:#e2777a}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property{color:#f8c555}.token.keyword{color:#cc99cd}.token.attr-value,.token.string{color:#7ec699}.token.operator{color:#67cdcc}.theme-default-content code{padding:.25rem .5rem}.theme-default-content pre[class*=language-]{line-height:1.4;padding:1.25rem 1.5rem;margin:.85rem 0;background-color:#282c34;border-radius:6px;overflow:auto}.theme-default-content pre[class*=language-] code{color:#fff;padding:0;background-color:transparent;border-radius:0}div[class*=language-]{position:relative;background-color:#282c34;border-radius:6px}div[class*=language-] pre[class*=language-]{background:transparent;position:relative;z-index:1}div[class*=language-]:before{position:absolute;z-index:3;top:.8em;right:1em;font-size:.75rem;color:hsla(0,0%,100%,.4)}div[class~=language-js]:before{content:"js"}div[class~=language-html]:before{content:"html"}div[class~=language-javascript]:before{content:"js"}.theme-default-content:not(.custom){max-width:740px;margin:0 auto;padding:2rem 2.5rem}@media (max-width:959px){.theme-default-content:not(.custom){padding:2rem}}@media (max-width:419px){.theme-default-content:not(.custom){padding:1.5rem}}body,html{padding:0;margin:0;background-color:#fff}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:16px;color:#2c3e50}.page{padding-left:20rem}.navbar{z-index:20;right:0;height:3.6rem;background-color:#fff;box-sizing:border-box;border-bottom:1px solid #eaecef}.navbar{position:fixed;top:0;left:0}.sidebar{font-size:16px;background-color:#fff;width:20rem;position:fixed;z-index:10;margin:0;top:3.6rem;left:0;bottom:0;box-sizing:border-box;border-right:1px solid #eaecef;overflow-y:auto}.theme-default-content:not(.custom)>:first-child{margin-top:3.6rem}.theme-default-content:not(.custom) a:hover{text-decoration:underline}a{font-weight:500;text-decoration:none}a{color:#3eaf7c}blockquote{margin:1rem 0}blockquote>p{margin:0}ul{padding-left:1.2em}strong{font-weight:600}h2,h3,h4{font-weight:600;line-height:1.25}h1:hover .header-anchor,h2:hover .header-anchor,h3:hover .header-anchor,h4:hover .header-anchor,h5:hover .header-anchor,h6:hover .header-anchor{opacity:1}h2{font-size:1.65rem;padding-bottom:.3rem;border-bottom:1px solid #eaecef}h3{font-size:1.35rem}a.header-anchor{font-size:.85em;float:left;margin-left:-.87em;padding-right:.23em;margin-top:.125em;opacity:0}a.header-anchor:hover{text-decoration:none}code{font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace}p,ul{line-height:1.7}table{border-collapse:collapse;margin:1rem 0;display:block;overflow-x:auto}tr{border-top:1px solid #dfe2e5}tr:nth-child(2n){background-color:#f6f8fa}td,th{border:1px solid #dfe2e5;padding:.6em 1em}@media (max-width:959px){.sidebar{font-size:15px;width:16.4rem}.page{padding-left:16.4rem}}@media (max-width:850px){.sidebar{top:0;padding-top:3.6rem;transform:translateX(-100%);transition:transform .2s ease}.page{padding-left:0}}@media (max-width:419px){.theme-default-content div[class*=language-]{margin:.85rem -1.5rem;border-radius:0}}</style>
  <style type="text/css"></style><meta name="description" content="Node学习指南"><link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAWiUlEQVR4Xu1dC3Bc1Xn+/nt39bRk+W2wjVYP4wTTYIZHIKFgAtbKScMkZAq0QOM2pU0aEqBNp8OkFJgUMkOTYEoyoTRTIC2d6UATKKGWZEzMw6YZjCRDTdsAtokENn6/pH3de/7Of3dXluS9u/fevat7V/KZ8diW/nPO//jOf/7zn8clnC6BaID3dMdg4jEw7qVlPZsDYQIABdXxTO+Xh7o3g3BFTg9/SEt7Hg9CJ6cBEIDW+cOuL0BpP7e6Zj6KWakYzdl8JABWTnuAIJTOw927AbRmAWBNAfcEwYf0edoDTLHmeaj7HhDuznX7Pi3tiU0xCxO6Ow2AKdS+FfgZPACiltzovzLIAHBaeAB+N94JxW0gfRlILQFoCUgtBLTZYBwHcAQwDwDYA53eQ7r2VVrxnPx/ygsPd0ug9+Wc8V+iZT2rp5yJSR1WlQfg3Vd/HKZ2M0i7EhrOQQTNnhSomKGQgsIQWPsZao48QMteO+SpLYeVeKh7NQi/HCPX0UZn9EgsEGgJPQD4vfjt0PF1EFqhU7Ri2srwPijuA8zvUMemX/vdDw/HBwE6LwyB33jZQgsA7o//ARrpfjRiid/GKNleho/C5F+CzL/yAww83L0OwGNZ4we77Jsse6gAwP1rzgTRrYD2x2jCAtSVNFVlCZgZaWwG8w3U2bfPS2d8eHULTtTuGgv8gMCSPoX4DwUAeNvVs6FFvgPCN6ABaGKgJhSsZXUmEUOGn6b23uvdgoCH4+sBus2vwE8A5WfSKFAtM4OwvesWsPa3ABZYWQlZIEVcqFmfDVC2Akfm5fQcBbRcfMgGiI9mGzRHQZwA1DFAZVx0kiM1kUZGPUCdfXc5qZzL9+8ao2V4XvblPMljIFqFxuT5foEgMADwwJpPA9oPAVplKcjpyNcbwNpccOQMsD4P0DzGhWoUZB4EGQdA6pAFDsfF4MMwzZup44Xni9WZlO9/gpb2SCzgulipY5PE+Ln8AT9Dy3q/6LqhAhWmHAC8Y/UspOseAXDjBH5kwNbaiKTPhoouBevzAd3byq+UsiizF2TsAZkfOfMOigGDn6D2PlujZpd+vB6MmJd8vzXqR2rvBuj2CfwzfMshTCkAePvapTDVRhB9bIJAjQAa7E2k6i8C260Ac26/lIEd/15lQOZeaOlfO/MKad4NSp1PbfabOTy8ZhUt3TjomAeZzobXrAJ02TA6mSqWFQThHlrau95NW8VopwwAvL3rk1Dac9ZcP77UAJjtgzj6bLDWAKZmQK/PTQ9FUOWgS8oMOQOCgSTYvJTa3BnZjoVJ+wU5Mt4OqHVugVRKzCkBAPd3XwPCUwDE3CeLzPtzcvN/KU69/F5Aoc/L/oku9tKCNR1oxk5QskRuSLGBNLqos/dkts9lj9lRrz02Fhfl61dwx7DiAOD++F0g3AvQqX1JSOMxhnOpWytY5MhiqGgbICsHt0WNQk9sA8zciqJQfSvBrH6fOvv+zW3zPBy/HYy7x+ULpIn3wVhXyQ2jigKAB7pl27PwXnc9gFlu1eQTvd4AVXM2OLrMdYNacgcovdO+niSPknwdLe972knj2UCvTub6yRtDT6Axebtfyz07XioGAB7svhaMfy/YsfQ6t4Ku34nmhSYPBH2xq+WkLB215Db71YJ4goS6ks7ue7kYK6cs74RYAj2d19GZfc84FaMcuooAgLevvQSK5aBj4YXdLAbqK9K1N11YQFjpLk4wj0FPbLUHgcQEprqoWGBouX3Qg2NMMz+LWal1lR7145XkuxW4/7OtIDWQC+9ONYgEfjL6fe/Zm+3H15JMoqqTOMzh6qFUXGBiBGf1NBNB2XFnJYvAq/xe3jnVhq9m4P/9dBMSs94AaLktA8USPk65rjCdqlsJrml31ovKQE+8bJ8zSOIl6rQ/+GGli2U8BHQ2wF8ADHT/M4CbbDWn50a/M9UGSsXRM6Bqz3MWGxSdDpiRwk3U0fuvgQpk07lvAMjm9vVXiwopUb9E/9VS9AaYdRc6WzYWA4HBGYr1TsyBhEQHvgCAGRoGu98GsMJWLulJNut86XEKtadFoWolQCy9ZLQyhwmbjG8Kr1BHz+VTyLmjrnwxBw90/yWAB4r22MBAoy/dORLMbyJVv8oRCLTkICg9VKB7Zozy6lJLQy98W7mE0doroOio26RR2Rbht65ahEx0F6iEc5fIX2KAKi6OQFAsKDRwmGI9oomyypjB2UoerR6XOna95Vw+APrjT4PoS0UlijLQUnZXZSnNr8pOQGAlikZfK9xlWv01tffd54afIgaf3MxuWtrT5qbtsqzCb63tgMHvluywxHZvyfohI3ACAi2xDZTZcyrnBo5RrKfoZoQLg2czh4BcNN0MqM1udwvLA8Bg90NgfLOkfaZy06ckM/4QmI2XF18dSJLoxCYbL2DeSu0bfzT5l7a7geMJyzT45D7LA0B//AiIim+tSQ/z/VF6qFrRojAbriqaJ7ANCNPYT+09C08BQHZj6PCEn/tscN8AwANdNwLav5Q0Sg0Ds8vCWckugiKwUscNn7Lv3tYLSHKILqeOnlPyJrnU8BGvLt2tLjxbhge65eBD6bttVb78K6VQVbMCXHe2LZmtF0ipl6mjL/9ARKluKvZ7TwDgt7qWwdB+44irJiDwCx6OGPVOZIoXsDmbaLsiUDDprB43B+C9M1ikpjcADHR9C9D+zhFHcxiIeOrGUfOhINJnwwoKbYo+sqnwZlHS/BZ1bvx+kDJ4sgwPxJ8D6HccMS4BoKdeHLUeGqJiO4hygkhOEp1SUmoLdfRdFqQQrk1j3eYZjB8DqPSBrira/SvbCMVWBbJRNPLSqV1k+Di19VbmooNDgdwDoD9+HoicnXHXGZjruguHrIePrFhAqJ/oKXB6iBkJrYWWbzgWlDSurcOD8VvB9LAjhuXEb/Yy08woRbyA7WogQXfQ8g2+XfRwq2j3AHCS+89zMY1zAHaKtvMCtnFAkn9Gnb3F91LcWtUFvXsADMQPAuRsR6uOgSbXXbhgP4Skdl7AOAh9dGuBQJB3UEfvuUFJ4so6/Obn5sA0nb+lIw88SB5ghpWCm0WyTSxxwORi4BDFerL32gMo7gDgdPdvbArw6d5fAIopp0u7FLF+TK5GTioBJ4TcAaB/zYUg/XXHyplG5wAcy5wjNGfJRtHE4+Xa6FaQcXBSU8xY0hspdnTcbd9u6N0BYKBrDaD1Oe4gwsAcV104bjrshIUSQ4UBAOD4iRX08Vd9f5nMiY5cWYcH49eByfnFR7kEEtjs5kT8ytEUmgZsAZBUn6XOvg2V48a+ZXcA6I9/FUQ/dsXoDEkFF9KJ2fz5CT+2BUCK/ow6NrjTqysj+AWAgfgtAD3qqu8WBqKucOaq+TATT94ltAVAmr9N7b33ByGLK8twf/xLIHJ07XlMmBmwHWxnOLleJrFAvtgDoPARsakAhEsArL0CZN36dV6CfAfAOZcVoZwcBxRcBkrPI5kbaMUm57GVj9y6A8BgfCWY/ttV/zNtP2C8cuRqWeNVYz+xBYDBn6GY96dlXNljErE7AMglECO613WHpwNBayewYCZQlJnIrKTlm+Rq3ZQXdwCwzgJ02951t+W+mYFaV11NuSIq1eFYIGi3FwArEVRDBKNSPBRr17VV2MlR8Mk9zsRNoZwOSgLA4DTFeu2eyKw4JrwAYCuILnXF2QxOCOU3hmwfl0rzXmrvPcOVPn0kdg+Aga77Ae1O1zzM0HxA/nyAPiKviBR4Yi6lfkUdfZe41qdPFdwDYHBNF1jvdd3/DJ0GLADULLW/JpZQ62l53x2u9elTBfcAeGdtLY6rE6DcG+1uGJF9AZkOZlARAMjTtbYPRxiqnWJ9J5+Un2LduAaA8Mf9cfdxgFSstidifDCGAID4mM1N4WADQBHPGwC8xgEhfiLOB1sXbEIAoKX/r3DzGd5BbcEdB/MOgH4PKeG8Cmba3oC8S2z3vvAoPURnb5j4LYBKIdGmXU8eIDcNvAOiTtf8zkAvUFhH8qbw8cXUudXTx6hc691/AHR/E4SHPDEyzV4M8aSDtNpJ7X0dnur6WMm7B5BXQUeb9oKKfeujCKfT4NGosuyQNL5BnS/8sKw2fKjsGQDWNDAQfxSgWzzxMUPzApauTM5QazgejiwPAP1rzwFxgWuvDiFRBe8GO5TEHVkST1Cnty+IueuoNHVZAMgFg95yAvk1iHwypsrfDyyt5nEUJmdwVm9DULt/k3ktHwAD3fJMjOfv5FjGFxCUzYkrMwRHnMTD1NlT+mW1KeLQF7VzqVfCSwkzU+IBEylq7Qn6i8gTrOEPAP7nqnlIRt4Fcl+2LGXwQr+f9ktDWffTH1Fnz+Ne1FOpOr4AwIoFBrv+BKz9Q1mMTue9ghS/Th29F5elnwpU9g0AuWXhFoCKPJznQILpCAITKUT3z6Uz33DxgWIHuvKBxF8ADH5mCVTNIKjMt0Gn036BfEYuwXE6u2+jD/byvQlfAWB5gTe7LoCpbSnyKWhnQjQy0OA7e8769o3KMv63aXnfd31r0ueGKqLhot8MdCOA3CmQZFG1HiJJ8QvU0bvGjchTTVsRAGSDwvi9YPqbsgUS48ux8mq7X5jBB9TWs7Rs+SvcQMUAYIHAzYNSxQSl3AcnAn9Y1aE1DBzAyNASWrkj7bBGYGSVBcCOlTVILdsCwoVlS1jpL42XzWCugQzvQyzVSrQ56VeTlWynogCwvID1MckmeRyn/Jex6xmYVXGWves7w3sQa44RPRX6kZ8Xcsq0yQPxBwEq//hTWB+fTmOI2nvO8o6eYGpOGQAsbzDQvQ6Mn4DK2P8L476BzPmtTUuqaeRPuQfId8j9XZeDNPk0uuwBeithul9g4Bg42Uptm494EybYWlPqAcZA8ObV7TAiL4LQ6kn8sKSLDSTAyXZq2+z+yrwnwf2vFAgArOlg2+r50Gs3jvvooXPpwvDohGIgY1xMHZucv5voXMIpowwMABYIhi6tx4Hm/wDoatcSBz0NpPkX1N478Rkw10IEXyFQAGQ9wQVR6PP7AXL3YHKQ04DBSbT2Ngb1uqefsAkcANnVwZrlYO1NEDk/LSNPKgTyrQ052MG/R519gTzq5Kfxpa1QAMACwWD3n4LxiGMBg3p0IqXeoo6+TzjmM+SEoQFA1hPEfwHQ5xzrLIjLJQE+6ORYLy4IwwWA7V1tUNpOx/znD44wI2OYUCZDKYYyFZQCTKVABGiaBl0jkE7QiaBFNEQi4kJcih+Cjzw51o1DQpcacNhqGWQ80P0KgNKfUmNGGiaSNRmk04a8teWuECOi66irj1p/SJBSqqTwc+roubYUWTX93oHUUysO93d/BYSf2PUqozyZVEhnTIAJak4KpqzJyyqMuvoaNDbWQNOLnD6ZZu4/VEFg3n68vasRJh2YvCKwjtaNmkin5ZnCk7ilORmklVmW+U9WZtTVRTGrue5Uj2DgOMV6All3+CRcwWZC5wGyweDEacDIKIyMiJs/lV2tWW5bZHzVkaYTmpvrEK0ZdwIlxW9QR2/55xp85bT8xsIJgP74T0F0s4hnGIwTJzKWuy9UqN5EusZfAFj9EKOlpeEkCNL8LLX3fqF8lYerhXACYKD7HgB3K6Vw7GgJ9x5RyDRW6PwFAXPnNUDXdSDBP6DlvX8RLvOVz01YAfBlAI+PjhhIp0sHeEZL0v0qwKHuJCZoml0HpNRXqKPvnxxWqxqycALgzc9fwUZ689Ej4tpLs8hz0zBM929YO7XS/AWNIGVcQLEX+53WqRa60toNQJLUu/edS4c2vzVywplR/V0JnCpwS0s9ajpeCKWuyjVPKIUaHXpuif7Bw8Ojo86Wd9psA6kKvrbeNKsO9Ss2hVJX0xIAzKyb2+LG8eMOATDLQEqv3HP7zc1zuW75c9V6P6koRkKJ6uHhg0tnH/77IePAK7bLv/FSUZ1CurYyKwHSgIamK4zGzvvlHNK0K6EEgHiAD957Iz1v352apH1LFYoqpBsqA4CGhlrsq31yW3v7GReV4qMafx9KAIgid+36aEdz4vlzIvuetHb2ihZNIdPkPwB0nWDMugOj+m//tK1toSxNp10JMQD23wHwD+ac+EfgwIsl1/mZ2QlHS0anFpR0sN54DY5E1oFI/1QsNu81p3WriS60AJBpYPfufa8AdGlj4kXUH3wMRsY+0PMzGRSN6lCNv4tj2vWyM/FIW9uir1WTUd3wGloAZKeBwy1A+lWAVurqEFoOPwg+/i4K7f76sS2saYTausU4Un8fDLburfxnLLbgGiJythxxo/mQ0IYaAKKjPXuOL0ilEi8wwzqHF+H9aDryOPSR7TDkTECuUIuBNHtbCkYiOiJ1K3C09s9hcP5z5/TjWGz+7UTkf3AREuMLG6EHgDDJzDXDwwcOGQbLY3JjpT71OupObISe2g2lH0MqmnKkWjn8E41EQZFFSEWuwkh0/CYfIxLRn1q2bP51jhqrcqKqAIDoeO/eg+uZcVsmo6wt4sknuDRKoJFfRsR8D5raD1YjgJkAtCgYjVDUDJMWIq2fi7R+QUGzRSJknRXUNL1j0aIW52cTqxgEVQGA/fv3N504ofZHIlptNJo9zGmaCpkMi3fwrH6pKju9YnTdOgomh0oxmMngxtbWeYF8ytWzMB4rVgUARLbdu/edD+BXzIiKwWS0ihcQAEieQIx58t8CChoDR95byMFPTYN13Et+Juv8fJE2DEO8i1JEuLOtbdEDHnVaVdWqBgCyLPzwwwMPE9HXZAowTYZE7QIE+dvJod7JlrGOkCuGYcWOVntcU6N/YvHiue6+kF5VJp/IbNUA4P3391+glNqiaTINiMFlGhAgZO8AZM//nwSC/Ht8Ee+QPVOYuzuQyy6KF5A/Qm8Y5juZDPra2xfeWsU2dcV61QBApJJNIqXUNtPkRScNl13M5KeArKGzU0J2BZEFR/7fMgVkgZKfQmCBSLwKgCQz39Xevuh7rrRYxcRVBQAJBlMp7XFdx7ViNNOE5cLzIz9rXIni7Swio58gZw2tm0NmFiUCBgkGa2ujNyxc2DItLn06xWRVAWDnzo8WaRrtAGheJJKN3mWES/AmfwsYnC4K8p4gGwgSZHnJzNtisYXTctfPDhBVBQARYmjowHpNw23issXdj5/DTwqZHeky34+fArKjPTvixQMIYMQLyN8STKbTuKmjY8GTTkfPdKCrOgDs2rX/9mgUD8rozxtP/hZDj58KChkn6yWyhs8HjfkAUDyAaWJ1W9uCl6aDYZ3KUHUA2LnzcKumZd6NRimSTd6cDPAm5wTGKyEfCOYDwHycIHVkGWgYam8stqB1uuf+JwOj6gAgAuza9dE9AN0tozefB3CK+PF04jlkKlHK8h9fbGub/6yXdqq5TlUCgJlp5859DxPh69nsXjbDJ9NCqYRQPmjMTwVKKdY0/attbQserWZDeuW9KgGQF/b119/+r/r6hk/W19dZy7/xQV4+2MsGgtkkkMz9+WIYJhKJUSSTqR9dfPE5MybxMy2mgLwQW7a83UpkPK9p2sra2lrU19db9/gkNpj84AOzBHmS8DGQSCSQSsk2P28wzZrrL7vsY8e9jqBqr1fVHkCUv3XrUD3R4fuY6RYiyONxVrGehdF1a/Sbpjl513AvEb53ySW/9f1qN2C5/Fc9APIK2L59e+PoqCZXyq9j5oUAzSXCPMA6JnQIoEPM+I2m0ROJxMpnrrySvB0fKlfjIav//4cXV/lHsYx8AAAAAElFTkSuQmCC"><style>.sf-hidden{display:none!important}</style><link rel="canonical" href="https://interview2.poetries.top/fe-nodejs-docs/nodejs-docs/express/-1.2 Express.html"><meta http-equiv="content-security-policy" content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
  <body class>
    <div id="app"><div class="theme-container posr custom-code-highlight"><div><header class="navbar"> 
          <div class="sidebar-button" style="
          width: 1rem;
      "><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div>  <div class="links" style="max-width:1146px"> <nav class="nav-links can-hide"><div class="nav-item"><div><a href="./fe-nodejs-docs-nodejs-docs-base-01-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" class="nav-link">Node指南
  </a></div></div><div class="nav-item"><div><a href="./fe-nodejs-docs-node-graphql-note-01-Graphql%20API%20%E4%BB%8B%E7%BB%8D.html" class="nav-link">GraphQL服务
  </a></div></div><div class="nav-item"><div><a href="./fe-nodejs-docs-node-devops-note-01-%E7%8E%AF%E5%A2%83%E7%AF%87%20%E8%99%9A%E6%8B%9F%E6%9C%BA%20&amp;%20GitLab.html" class="nav-link">Node Devops
  </a></div></div><div class="nav-item"><div><a href="./fe-nodejs-docs-node-interview-nodes--IO.html" class="nav-link">Node面试
  </a></div></div> <!----></nav> </div></header></div> <div class="sidebar-mask sf-hidden"></div> <aside class="sidebar"><nav class="nav-links sf-hidden"> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>基础篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="./fe-nodejs-docs-nodejs-docs-base-01-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" class="sidebar-link">环境搭建</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-base-02-node%E9%83%A8%E7%BD%B2.html" class="sidebar-link">node部署</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-base-03-%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8.html" class="sidebar-link">基础应用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>内置模块</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="./fe-nodejs-docs-nodejs-docs-modules--1.0%20%E6%9C%AC%E5%9C%B0%E8%B7%AF%E5%BE%84%E5%A4%84%E7%90%86%20path.html" class="sidebar-link">1.0 本地路径处理 path</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--2.0%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%93%8D%E4%BD%9C%20fs.html" class="sidebar-link">2.0 文件系统操作 fs</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--3.1%20%E5%9F%BA%E7%A1%80%E8%B0%83%E8%AF%95%20console.html" class="sidebar-link">3.1 基础调试 console</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--3.2%20%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E8%BF%9C%E7%A8%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84Node%E4%BB%A3%E7%A0%81.html" class="sidebar-link">3.2 本地调试远程服务器上的Node代码</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.1%20%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%20http.html" class="sidebar-link">4.1 网络服务 http</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.2%20%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%20http%20res.html" class="sidebar-link">4.2 网络服务 http res</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.3%20%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%20http%20req.html" class="sidebar-link">4.3 网络服务 http req</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.4%20%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%20http%20server.html" class="sidebar-link">4.4 网络服务 http server</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.5%20%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%20http%20client.html" class="sidebar-link">4.5 网络服务 http client</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.6%20%E7%BD%91%E7%BB%9C%E6%9C%8D%E5%8A%A1%20https.html" class="sidebar-link">4.6 网络服务 https</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.7%20%E7%BD%91%E7%BB%9CTCP%20net.html" class="sidebar-link">4.7 网络TCP net</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.8%20%E7%BD%91%E7%BB%9CUDP%20dgram.html" class="sidebar-link">4.8 网络UDP dgram</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--4.9%20%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%20dns.html" class="sidebar-link">4.9 域名解析 dns</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--5.0%20%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%20url.html" class="sidebar-link">5.0 网络地址解析 url</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--5.1%20URL%E6%9F%A5%E8%AF%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%20querystring.html" class="sidebar-link">5.1 URL查询字符串 querystring</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--6.1%20%E6%B5%81%E6%93%8D%E4%BD%9C%20stream.html" class="sidebar-link">6.1 流操作 stream</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--6.2%20%E9%80%90%E8%A1%8C%E8%AF%BB%E5%8F%96%20readline.html" class="sidebar-link">6.2 逐行读取 readline</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--7.1%20%E8%BF%9B%E7%A8%8B%E7%9B%B8%E5%85%B3%20process.html" class="sidebar-link">7.1 进程相关 process</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--7.2%20%E5%AD%90%E8%BF%9B%E7%A8%8B%20child.html" class="sidebar-link">7.2 子进程 child</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--8.1%20%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%20buffer.html" class="sidebar-link">8.1 二进制数据 buffer</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--8.2%20%E4%BA%8C%E8%BF%9B%E5%88%B6%E8%A7%A3%E7%A0%81%20string_decoder.html" class="sidebar-link">8.2 二进制解码 string_decoder</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--9.1%20%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6%20events.html" class="sidebar-link">9.1 事件机制 events</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--9.2%20%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7%E6%A8%A1%E5%9D%97%20util.html" class="sidebar-link">9.2 实用工具模块 util</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--9.3%20%E6%95%B0%E6%8D%AE%E5%8A%A0%E5%AF%86%20crypto.html" class="sidebar-link">9.3 数据加密 crypto</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--9.4%20MD5%E5%85%A5%E9%97%A8%E4%BB%8B%E7%BB%8D%E5%8F%8Acrypto%E6%A8%A1%E5%9D%97%E7%9A%84%E5%BA%94%E7%94%A8.html" class="sidebar-link">9.4 MD5入门介绍及crypto模块的应用</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--9.4%20%E8%B5%84%E6%BA%90%E5%8E%8B%E7%BC%A9%20zlib.html" class="sidebar-link">9.4 资源压缩 zlib</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--9.5%20%E9%9B%86%E7%BE%A4%20cluster.html" class="sidebar-link">9.5 集群 cluster</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-modules--9.6%20v8.html" class="sidebar-link">9.6 v8</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>进阶篇</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="./fe-nodejs-docs-nodejs-docs-advance--5%E5%88%86%E9%92%9F%E5%85%A5%E9%97%A8%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%94%A8%E6%B3%95.html" class="sidebar-link">5分钟入门非对称加密用法</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--cluster.html" class="sidebar-link">cluster</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--cookie_parser%E6%B7%B1%E5%85%A5.html" class="sidebar-link">cookie_parser深入</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--crypto%E6%A8%A1%E5%9D%97%E4%B9%8B%E7%90%86%E8%AE%BA%E7%AF%87.html" class="sidebar-link">crypto模块之理论篇</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--express+cookie_parser%EF%BC%9A%E7%AD%BE%E5%90%8D%E6%9C%BA%E5%88%B6%E6%B7%B1%E5%85%A5%E5%89%96%E6%9E%90.html" class="sidebar-link">express+cookie_parser：签名机制深入剖析</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--express+session%E5%AE%9E%E7%8E%B0%E7%AE%80%E6%98%93%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81.html" class="sidebar-link">express+session实现简易身份认证</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--https.html" class="sidebar-link">https</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--log4js%E5%85%A5%E9%97%A8%E5%AE%9E%E4%BE%8B.html" class="sidebar-link">log4js入门实例</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--node8_napi.html" class="sidebar-link">node8_napi</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E4%BD%BF%E7%94%A8%20async%20%E6%8E%A7%E5%88%B6%E5%B9%B6%E5%8F%91.html" class="sidebar-link">使用 async 控制并发</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E4%BD%BF%E7%94%A8%20eventproxy%20%E6%8E%A7%E5%88%B6%E5%B9%B6%E5%8F%91.html" class="sidebar-link">使用 eventproxy 控制并发</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E4%BD%BF%E7%94%A8%20superagent%20%E4%B8%8E%20cheerio%20%E5%AE%8C%E6%88%90%E7%AE%80%E5%8D%95%E7%88%AC%E8%99%AB.html" class="sidebar-link">使用 superagent 与 cheerio 完成简单爬虫</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E5%9F%BA%E4%BA%8Eexpress+muter%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html" class="sidebar-link">基于express+muter的文件上传</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E5%B0%86%E5%9B%BE%E7%89%87%E8%BD%AC%E6%88%90datauri%E5%B5%8C%E5%85%A5%E5%88%B0html.html" class="sidebar-link">将图片转成datauri嵌入到html</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E5%B8%B8%E7%94%A8%E4%B8%AD%E9%97%B4%E4%BB%B6%20body_parser%20%E5%AE%9E%E7%8E%B0%E8%A7%A3%E6%9E%90.html" class="sidebar-link">常用中间件 body_parser 实现解析</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97morgan.html" class="sidebar-link">日志模块morgan</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%AD%97%E7%AC%A6%E7%BC%96%E8%A7%A3%E7%A0%81&amp;%E4%B9%B1%E7%A0%81%E5%A4%84%E7%90%86%20charset_enc_dec.html" class="sidebar-link">服务端字符编解码&amp;乱码处理 charset_enc_dec</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%EF%BC%9Amocha%EF%BC%8Cshould%EF%BC%8Cistanbul.html" class="sidebar-link">测试用例：mocha，should，istanbul</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-advance--%E8%B0%83%E8%AF%95%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0%EF%BC%9Adebug%E6%A8%A1%E5%9D%97.html" class="sidebar-link">调试日志打印：debug模块</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Express</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="./fe-nodejs-docs-nodejs-docs-express--1.1%20Express%E6%A6%82%E8%A7%88%E7%AF%87.html" class="sidebar-link">1.1 Express概览篇</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html" class="active sidebar-link">1.2 Express</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8" class="sidebar-link">Express 基础应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%B7%AF%E7%94%B1" class="sidebar-link">路由</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-%E4%BD%BF%E7%94%A8" class="sidebar-link">Express 使用</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#get" class="sidebar-link">GET</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#post" class="sidebar-link">POST</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%B7%A8%E5%9F%9F%E6%94%AF%E6%8C%81-%E6%94%BE%E5%9C%A8%E6%9C%80%E5%89%8D%E9%9D%A2" class="sidebar-link">跨域支持(放在最前面)</a></li></ul></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-koa-%E5%92%8C-egg-%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE" class="sidebar-link">Express Koa 和 Egg 基础配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express" class="sidebar-link">Express</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#koa" class="sidebar-link">Koa</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#egg" class="sidebar-link">Egg</a></li></ul></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-%E8%BF%87%E6%BB%A4%E5%99%A8" class="sidebar-link">Express 过滤器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8" class="sidebar-link">简单使用</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%BF%90%E8%A1%8C%E8%A7%84%E5%88%99" class="sidebar-link">运行规则</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%85%A8%E5%B1%80%E4%BD%BF%E7%94%A8-use" class="sidebar-link">全局使用--use</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8-2" class="sidebar-link">简单使用</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%AE%BF%E9%97%AE%E6%89%80%E6%9C%89%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6" class="sidebar-link">访问所有静态资源文件</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E6%89%80%E6%9C%89-post-%E4%BD%BF%E7%94%A8-body-parser" class="sidebar-link">所有 post 使用 body-parser</a></li></ul></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0" class="sidebar-link">Express 文件上传</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-https%E6%9C%8D%E5%8A%A1%E5%99%A8" class="sidebar-link">Express https服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%8E%9F%E7%94%9F" class="sidebar-link">原生</a></li><li class="sidebar-sub-header"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-2" class="active sidebar-link">Express</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Koa2</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--1.0%20koa2%E6%A6%82%E8%A7%88%E7%AF%87.html" class="sidebar-link">1.0 koa2概览篇</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--1.1%20%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B.html" class="sidebar-link">1.1 快速开始</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--1.2%20async%20await%E4%BD%BF%E7%94%A8.html" class="sidebar-link">1.2 async await使用</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--1.3%20koa2%E7%AE%80%E6%9E%90%E7%BB%93%E6%9E%84.html" class="sidebar-link">1.3 koa2简析结构</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--1.4%20koa%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%BC%80%E5%8F%91%E4%B8%8E%E4%BD%BF%E7%94%A8.html" class="sidebar-link">1.4 koa中间件开发与使用</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--10.1%20%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95.html" class="sidebar-link">10.1 单元测试</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--11.1%20%E5%BC%80%E5%8F%91debug.html" class="sidebar-link">11.1 开发debug</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.1%20%E5%BF%AB%E9%80%9F%E5%90%AF%E5%8A%A8.html" class="sidebar-link">12.1 快速启动</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.2%20%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1.html" class="sidebar-link">12.2 框架设计</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.3%20%E5%88%86%E5%B1%82%E6%93%8D%E4%BD%9C.html" class="sidebar-link">12.3 分层操作</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.4%20%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1.html" class="sidebar-link">12.4 数据库设计</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.5%20%E8%B7%AF%E7%94%B1%E8%AE%BE%E8%AE%A1.html" class="sidebar-link">12.5 路由设计</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.6%20webpack4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.html" class="sidebar-link">12.6 webpack4环境搭建</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.7%20%E4%BD%BF%E7%94%A8react.html" class="sidebar-link">12.7 使用react</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.8%20%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0.html" class="sidebar-link">12.8 登录注册功能实现</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--12.9%20session%E7%99%BB%E5%BD%95%E6%80%81%E5%88%A4%E6%96%AD%E5%A4%84%E7%90%86.html" class="sidebar-link">12.9 session登录态判断处理</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--13.1%20import%20export%E4%BD%BF%E7%94%A8.html" class="sidebar-link">13.1 import export使用</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--2.1%20%E5%8E%9F%E7%94%9Fkoa2%E5%AE%9E%E7%8E%B0%E8%B7%AF%E7%94%B1.html" class="sidebar-link">2.1 原生koa2实现路由</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--2.2%20koa%20router%E4%B8%AD%E9%97%B4.html" class="sidebar-link">2.2 koa router中间</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--3.1%20GET%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96.html" class="sidebar-link">3.1 GET请求数据获取</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--3.2%20POST%E8%AF%B7%E6%B1%82%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96.html" class="sidebar-link">3.2 POST请求数据获取</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--3.3%20koa%20bodyparser%E4%B8%AD%E9%97%B4%E4%BB%B6.html" class="sidebar-link">3.3 koa bodyparser中间件</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--4.1%20%E5%8E%9F%E7%94%9Fkoa2%E5%AE%9E%E7%8E%B0%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1%E5%99%A8.html" class="sidebar-link">4.1 原生koa2实现静态资源服务器</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--4.2%20koa%20static%E4%B8%AD%E9%97%B4%E4%BB%B6.html" class="sidebar-link">4.2 koa static中间件</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--5.1%20koa2%E4%BD%BF%E7%94%A8cookie.html" class="sidebar-link">5.1 koa2使用cookie</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--5.2%20koa2%E5%AE%9E%E7%8E%B0session.html" class="sidebar-link">5.2 koa2实现session</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--6.1%20koa2%E5%8A%A0%E8%BD%BD%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E.html" class="sidebar-link">6.1 koa2加载模板引擎</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--6.2%20ejs%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E.html" class="sidebar-link">6.2 ejs模板引擎</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--7.1%20busboy%E6%A8%A1%E5%9D%97.html" class="sidebar-link">7.1 busboy模块</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--7.2%20%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0.html" class="sidebar-link">7.2 上传文件简单实现</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--7.3%20%E5%BC%82%E6%AD%A5%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E5%AE%9E%E7%8E%B0.html" class="sidebar-link">7.3 异步上传图片实现</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--8.1%20mysql%E6%A8%A1%E5%9D%97.html" class="sidebar-link">8.1 mysql模块</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--8.2%20async%20await%E5%B0%81%E8%A3%85%E4%BD%BF%E7%94%A8mysql.html" class="sidebar-link">8.2 async await封装使用mysql</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--8.3%20%E9%A1%B9%E7%9B%AE%E5%BB%BA%E8%A1%A8%E5%88%9D%E5%A7%8B%E5%8C%96.html" class="sidebar-link">8.3 项目建表初始化</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--9.1%20%E5%8E%9F%E7%94%9Fkoa2%E5%AE%9E%E7%8E%B0JSONP.html" class="sidebar-link">9.1 原生koa2实现JSONP</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-koa2--9.2%20koa%20jsonp%E4%B8%AD%E9%97%B4%E4%BB%B6.html" class="sidebar-link">9.2 koa jsonp中间件</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="./fe-nodejs-docs-nodejs-docs-other-01-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93.html" class="sidebar-link">操作数据库</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-other-02-Session%20%E4%B8%8E%20Token.html" class="sidebar-link">Session 与 Token</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-other-03-Cookie%E3%80%81Session%E3%80%81Token%E3%80%81JWT.html" class="sidebar-link">Cookie、Session、Token、JWT</a></li><li><a href="./fe-nodejs-docs-nodejs-docs-other-04-Socket.html" class="sidebar-link">Socket</a></li></ul></section></li></ul> </aside> <main class="page"> <div id="container" class="theme-default-content"><div class="content__default"><h2 id="express-基础应用"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8" class="header-anchor">#</a> Express 基础应用</h2> <p>Express 是一个第三方模块，对原生模块封装了一套更灵活、更简洁的应用框架，其在 Node.js 环境的地位和作用好比 jQuery 在前端的地位和作用。</p> <h3 id="路由"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%B7%AF%E7%94%B1" class="header-anchor">#</a> 路由</h3> <p>在 BS 架构中，路由的概念都是一样的，可理解为根据客户端请求的 URL 映射到不同的方法实现，更多的一般都是针对 URL 中的路径，或者是参数，又或者是锚点这些信息进行映射。</p> <h3 id="express-使用"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-%E4%BD%BF%E7%94%A8" class="header-anchor">#</a> Express 使用</h3> <ul><li>因为 Express 是第三方模块，所以在使用前要先安装 <code>npm install express</code></li> <li>加载模块</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><ul><li>开启服务器，定义端口8080：</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server running on http://localhost:8080'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="get"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#get" class="header-anchor">#</a> GET</h3> <ul><li>定义根路由，我们定义端口为 8080，当我们访问：http://localhost:8080/，会自动触发方法，会在页面上显示 Root Page。</li> <li><code>response.send()</code> 可理解为 <code>response.end()</code>，其中一个不同点在于 <code>response.send()</code> 参数可为对象。</li> <li>只有 GET 访问能触发</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Root Page'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><ul><li>定义 getUsers 路由，当我们访问：http://localhost:8080/getusers，会自动触发方法，会在页面上显示 getUsers Page。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/getUsers'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'getUsers Page'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><ul><li>Node.js 默认是不能访问静态资源文件（<em>.html、</em>.js、<em>.css、</em>.jpg 等），如果要访问服务端的静态资源文件则要用到方法 <code>sendFile</code></li> <li>__dirname 为 Node.js 的系统变量，指向文件的绝对路径。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/index.html'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span> __dirname <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> <span class="token string">"index.html"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="get-参数接收之-query-strings"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#get-%E5%8F%82%E6%95%B0%E6%8E%A5%E6%94%B6%E4%B9%8B-query-strings" class="header-anchor">#</a> GET 参数接收之 Query Strings</h4> <p>访问地址：<code>http://localhost:8080/getusers?username=dk&amp;age=18</code>，可通过 <code>request.query</code> 来获取参数</p> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/getUsers'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
        username<span class="token punctuation">:</span> request<span class="token punctuation">.</span>query<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> request<span class="token punctuation">.</span>query<span class="token punctuation">.</span>age
    <span class="token punctuation">}</span>
    response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="get-参数接收之路径方式"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#get-%E5%8F%82%E6%95%B0%E6%8E%A5%E6%94%B6%E4%B9%8B%E8%B7%AF%E5%BE%84%E6%96%B9%E5%BC%8F" class="header-anchor">#</a> GET 参数接收之路径方式</h4> <p>访问地址：<code>http://localhost:8080/getusers/admin/18</code>，可通过 <code>request.params</code> 来获取参数</p> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/getUsers/:username/:age'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
        username<span class="token punctuation">:</span> request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> request<span class="token punctuation">.</span>params<span class="token punctuation">.</span>age
    <span class="token punctuation">}</span>
    response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="post"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#post" class="header-anchor">#</a> POST</h3> <ul><li>post 参数接收，可依赖第三方模块 body-parser 进行转换会更方便、更简单，该模块用于处理 JSON, Raw, Text 和 URL 编码的数据。</li> <li>安装 body-parser <code>npm install body-parser</code></li> <li>参数接受和 GET 基本一样，不同的在于 GET 是 <code>request.query</code> 而 POST 的是 <code>request.body</code></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code><span class="token keyword">var</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建 application/x-www-form-urlencoded 编码解析</span>
<span class="token keyword">var</span> urlencodedParser <span class="token operator">=</span> bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/getUsers'</span><span class="token punctuation">,</span> urlencodedParser<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
        username<span class="token punctuation">:</span> request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
        age<span class="token punctuation">:</span> request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>age
    <span class="token punctuation">}</span>
   response<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="跨域支持-放在最前面"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%B7%A8%E5%9F%9F%E6%94%AF%E6%8C%81-%E6%94%BE%E5%9C%A8%E6%9C%80%E5%89%8D%E9%9D%A2" class="header-anchor">#</a> 跨域支持(放在最前面)</h3> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span> <span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Headers"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type,Content-Length, Authorization, Accept,X-Requested-With"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Methods"</span><span class="token punctuation">,</span><span class="token string">"PUT,POST,GET,DELETE,OPTIONS"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"X-Powered-By"</span><span class="token punctuation">,</span><span class="token string">' 3.2.1'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>method<span class="token operator">==</span><span class="token string">"OPTIONS"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/*让options请求快速返回*/</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h2 id="express-koa-和-egg-基础配置"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-koa-%E5%92%8C-egg-%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE" class="header-anchor">#</a> Express Koa 和 Egg 基础配置</h2> <h3 id="express"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express" class="header-anchor">#</a> Express</h3> <h4 id="处理请求"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82" class="header-anchor">#</a> 处理请求</h4> <ul><li>处理GET请求：配合<code>req.query</code></li> <li>处理POST请求：需要<code>body-parser</code>模块，配合<code>req.body</code></li></ul> <table><thead><tr><th>GET</th> <th>POST</th> <th>JSONP</th> <th>COOKIE</th></tr></thead> <tbody><tr><td>req.query</td> <td>req.body</td> <td>req.query</td> <td>req.cookies</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">//npm install express</span>
<span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//npm install body-parser</span>
<span class="token keyword">var</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"body-parser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//配置静态文件夹,在本地public读取css,js,html等文件</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//post请求需要body-parser模块处理</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	extended<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//get请求参数对象</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get请求参数对象:'</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
	res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'get请求'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//post请求参数对象</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'post请求参数对象:'</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
	res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'post请求'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> server <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> host <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>address<span class="token punctuation">;</span>
	<span class="token keyword">var</span> port <span class="token operator">=</span> server<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>port<span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Example app listening at http://%s:%s'</span><span class="token punctuation">,</span> host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="匹配路由参数"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%8C%B9%E9%85%8D%E8%B7%AF%E7%94%B1%E5%8F%82%E6%95%B0" class="header-anchor">#</a> 匹配路由参数</h4> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/add/:id/:age'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//追加请求头</span>
	res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//?id=xx&amp;age=xxx</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">)</span>
	<span class="token comment">//:id/:age</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">)</span>
	res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"Hello Oaoafly"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="跨域"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%B7%A8%E5%9F%9F" class="header-anchor">#</a> 跨域</h4> <p>可在中间件中追加这句防止跨域</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="模板文件"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6" class="header-anchor">#</a> 模板文件</h4> <p>这个设置视图文件的放置地方，然后配置jade为其模板渲染引擎，这里也需要安装jade模块实现</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">//views, 放模板文件的目录，比如： </span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'views'</span><span class="token punctuation">,</span> <span class="token string">'./views'</span><span class="token punctuation">)</span>
<span class="token comment">//view engine, 模板引擎</span>
app<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'jade'</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>然后安装对应的模板引擎npm包</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm install jade
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>然后创建一个views文件夹，并在里面新建一个<code>xxxx.jade</code>文件，内容如下</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>html
	head
	body
		h1 这是测试
		p 你好
			ul.hhh#ddd
				for n in news
					li=n.title
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><blockquote><p>在中间件中添加如下关键代码，res.render("文件名可省略后缀",{需要渲染在模板上的数据})</p></blockquote> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"select * from news"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">var</span> content <span class="token operator">=</span> <span class="token string">"Hello Oaoafly"</span><span class="token punctuation">;</span>
	res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">"qianfeng"</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
		<span class="token comment">//model</span>
		name<span class="token punctuation">:</span><span class="token string">'xie'</span><span class="token punctuation">,</span>
		name2<span class="token punctuation">:</span><span class="token string">'lan'</span><span class="token punctuation">,</span>
		news<span class="token punctuation">:</span>data
	    <span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">//res.send("&lt;p style='color:red'&gt;"+content+"&lt;/p&gt;");</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="静态文件"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6" class="header-anchor">#</a> 静态文件</h4> <ul><li>Express提供了内置的中间件express.static来设置静态文件如：图片， CSS，JavaScript等</li> <li>你可以使用<code>express.static</code>中间件来设置静态文件路径</li> <li>例如，如果你将图片， <code>CSS，JavaScript</code>文件放在public目录下</li> <li>在<code>app.js</code>根目录下创建一个<code>public</code>文件夹，然后在代码中添加</li></ul> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>app.use(express.static('public'));
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><ul><li>设置完静态文件夹后我们可以用<code>res.sendFile(文件路径)</code>方法来把文件发送到前端</li> <li>注意路径要用绝对路径<code>__dirname + "/public/" + "upload.html"</code></li></ul> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/index.html'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">"/public"</span> <span class="token operator">+</span> <span class="token string">"index.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>还有值得注意的一点就是，对于每个应用程序，可以有多个静态目录，比如你可以按上传的文件类型分目录，当我们找某张图片的时候就会从这几个静态文件夹中一起找取</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'uploads'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'files'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="连接数据库"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93" class="header-anchor">#</a> 连接数据库</h4> <p>连接数据库，可以安装mysql模块实现</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">var</span> mysql <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"mysql"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> connection <span class="token operator">=</span> mysql<span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		host<span class="token punctuation">:</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span>
		user<span class="token punctuation">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>
		password<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
		database<span class="token punctuation">:</span> <span class="token string">"asm"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//执行数据库连接 .close();</span>
connection<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/add'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//追加请求头</span>
	res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
	connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"insert into news (title,text) values ('"</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>title <span class="token operator">+</span> <span class="token string">"','"</span> <span class="token operator">+</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>text <span class="token operator">+</span> <span class="token string">"')"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"增加信息"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="body-parser"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#body-parser" class="header-anchor">#</a> body-parser</h4> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm install body-parser
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>然后通过<code>app.use()</code>方法调用</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// parse application/x-www-form-urlencoded </span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// parse application/json </span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="cookie-parser"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#cookie-parser" class="header-anchor">#</a> cookie-parser</h4> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm install cookie-parser
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>通过<code>app.use()</code>方法调用</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>var cookieParser = require('cookie-parser')
app.use(cookieParser())
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>然后在中间件中通过<code>req.cookies</code>获取前端页面的<code>cookie</code>，是一个通过处理的对象</p> <table><thead><tr><th>module</th> <th>description</th></tr></thead> <tbody><tr><td>querystring</td> <td>将GET请求url中的字符串信息进行转换</td></tr> <tr><td>chalk</td> <td>把控制台输出信息的字符串颜色改变</td></tr> <tr><td>body-parser</td> <td>将客户端通过POST方法传过来的</td></tr> <tr><td>cookie-parser</td> <td>处理cookie信息</td></tr> <tr><td>svg-captcha</td> <td>用来生成验证码</td></tr> <tr><td>trek-captcha</td> <td>用来生成验证码</td></tr> <tr><td>emailjs</td> <td>用来通过邮箱找回密码</td></tr> <tr><td>validator</td> <td>验证器</td></tr> <tr><td>mongodb</td> <td>连接mongodb数据库</td></tr> <tr><td>crypto</td> <td>express自带的加密模块</td></tr> <tr><td>express-session	session的认证机制离不开cookie，需要同时使用cookieParser中间件，可以用来保存用户的登陆状态，免密码登陆</td> <td></td></tr> <tr><td>formidable</td> <td>表单文件上传模块</td></tr></tbody></table> <blockquote><p><a href="https://blog.csdn.net/YUHUI01/article/details/81048256" target="_blank" rel="noopener noreferrer">node——常用的模块插件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h4 id="node上传文件"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#node%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6" class="header-anchor">#</a> node上传文件</h4> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm install multer
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>引用模块</strong></p> <p>它是依赖于express的一个模块</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">//引用express并配置</span>
<span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"express"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> multer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'multer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*var upload = multer({
	//如果用这种方法上传，要手动添加文明名后缀
        //如果用下面配置的代码，则可以省略这一句
	dest: 'uploads/'
})*/</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>配置</strong></p> <blockquote><p>设置保存文件的地方，并根据上传的文件名对应文件添加后缀可以通过<code>filename</code>属性定制文件保存的格式</p></blockquote> <table><thead><tr><th>属性值</th> <th>用途</th></tr></thead> <tbody><tr><td>destination</td> <td>设置资源的保存路径。注意，如果没有这个配置项，默认会保存在<code>/tmp/uploads</code>下。此外，路径需要自己创建</td></tr> <tr><td><code>filename</code></td> <td>设置资源保存在本地的文件名</td></tr></tbody></table> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">var</span> storage <span class="token operator">=</span> multer<span class="token punctuation">.</span><span class="token function">diskStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token comment">//设置上传后文件路径，uploads文件夹会自动创建。</span>
	<span class="token function-variable function">destination</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> file<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'./uploads'</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token comment">//给上传文件重命名，获取添加后缀名</span>
	<span class="token function-variable function">filename</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> file<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> fileFormat <span class="token operator">=</span> <span class="token punctuation">(</span>file<span class="token punctuation">.</span>originalname<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">//给图片加上时间戳格式防止重名名</span>
		<span class="token comment">//比如把 abc.jpg图片切割为数组[abc,jpg],然后用数组长度-1来获取后缀名</span>
		<span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> file<span class="token punctuation">.</span>fieldname <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> fileFormat<span class="token punctuation">[</span>fileFormat<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> upload <span class="token operator">=</span> <span class="token function">multer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	storage<span class="token punctuation">:</span> storage
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>接受文件</strong></p> <blockquote><p><code>upload.single('xxx')</code>，xxx与表单中的name属性的值对应这里虽然用到post请求，但实际上不需要bodyParser模块处理</p></blockquote> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/upload-single'</span><span class="token punctuation">,</span> upload<span class="token punctuation">.</span><span class="token function">single</span><span class="token punctuation">(</span><span class="token string">'logo'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>file<span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'文件类型：%s'</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>file<span class="token punctuation">.</span>mimetype<span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'原始文件名：%s'</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>file<span class="token punctuation">.</span>originalname<span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>file<span class="token punctuation">.</span>originalname<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'文件大小：%s'</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>file<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'文件保存路径：%s'</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>file<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
	res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		ret_code<span class="token punctuation">:</span> <span class="token string">'0'</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>多图上传</strong></p> <p>多图上传只要更改一下地方，前端往file输入框加多一个multiple="multiple"属性值，此时就可以在选图的时候多选了，当然也可以并列多个file输入框(不推荐多个上传图片输入框)，这样体验会不好</p> <div class="language-html extra-class"><pre class="language-html code-copy-added"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span> <span class="token attr-name">multiple</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multiple<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>后端也需要相应的改变</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/upload-single'</span><span class="token punctuation">,</span> upload<span class="token punctuation">.</span><span class="token function">single</span><span class="token punctuation">(</span><span class="token string">'logo'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//upload.single('logo')变为upload.array('logo', 2)，数字代表可以接受多少张图片</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/upload-single'</span><span class="token punctuation">,</span> upload<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token string">'logo'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>如果不想有图片数量上传限制，我们可以用<code>upload.any()</code>方法</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/upload-single'</span><span class="token punctuation">,</span> upload<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	
	res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Access-Control-Allow-Origin"</span><span class="token punctuation">,</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		wscats_code<span class="token punctuation">:</span> <span class="token string">'0'</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>前端部分</strong></p> <p><strong>formData表单提交</strong></p> <div class="language-html extra-class"><pre class="language-html code-copy-added"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://localhost:3000/upload-single<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>单图上传<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>提交<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>formData表单+ajax提交</strong></p> <div class="language-html extra-class"><pre class="language-html code-copy-added"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>uploadForm<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>指定文件名： <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>filename<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>上传文件： <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>&lt;/ p&gt;
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>上传<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doUpload()<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><blockquote><p><code>FormData</code>对象，是可以使用一系列的键值对来模拟一个完整的表单，然后使用<code>XMLHttpRequest</code>发送这个"表单"</p></blockquote> <p><strong>注意点</strong></p> <ul><li><code>processData</code>设置为<code>false</code>。因为<code>data</code>值是<code>FormData</code>对象，不需要对数据做处理。</li> <li><code>&lt;form&gt;</code>标签添加<code>enctype="multipart/form-data"</code>属性。</li> <li><code>cache</code>设置为false，上传文件不需要缓存。</li> <li>contentType设置为false。因为是由<code>&lt;form&gt;</code>表单构造的FormData对象，且已经声明了属性<code>enctype="multipart/form-data"</code>，所以这里设置为false上传后，服务器端代码需要使用从查询参数名为logo获取文件输入流对象，因为<code>&lt;input&gt;</code>中声明的是<code>name="logo"</code></li></ul> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">function</span> <span class="token function">doUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		url<span class="token punctuation">:</span> <span class="token string">'http://localhost:3000/upload-single'</span><span class="token punctuation">,</span>
		type<span class="token punctuation">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
		cache<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//不必须</span>
		data<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#uploadForm'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		processData<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//必须</span>
		contentType<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token comment">//必须</span>
		<span class="token function-variable function">success</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>改变样式</strong></p> <p>可以先隐藏文件上传输入框</p> <div class="language-html extra-class"><pre class="language-html code-copy-added"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>uploadForm<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logo<span class="token punctuation">"</span></span> <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>doUpload()<span class="token punctuation">"</span></span> <span class="token attr-name">multiple</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multiple<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>为需要出发文件上传的标签添加点击事件</p> <div class="language-html extra-class"><pre class="language-html code-copy-added"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>uploadImg()<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>headpic<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">function</span> <span class="token function">uploadImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#uploadForm input"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//代理文件上传的事件</span>
<span class="token punctuation">}</span>
<span class="token comment">//触发真正的幕后上传事件</span>
<span class="token keyword">function</span> <span class="token function">doUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//upload code</span>
<span class="token punctuation">}</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>携带其他参数</strong></p> <p>可以用原生的<code>append</code>对请求体继续添加内容，既可以上传图片也可以带其他参数</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">//构造form数据 </span>
<span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"avatar"</span><span class="token punctuation">,</span> fileNode<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"description"</span><span class="token punctuation">,</span> <span class="token string">"其他参数"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="热启动"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E7%83%AD%E5%90%AF%E5%8A%A8" class="header-anchor">#</a> 热启动</h4> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm install supervisor -g
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>全局安装后，就会有supervisor命令，它会自动检测你的文件变化，一旦变化则会自动重启</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>supervisor app.js
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="过滤器"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%BF%87%E6%BB%A4%E5%99%A8" class="header-anchor">#</a> 过滤器</h4> <p>可以设置对路由的拦截，比如用在登录拦截等</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">// filter.js</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">authorize</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//res.redirect('/beauty/test');</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
		<span class="token comment">//res.redirect('/beauty/getFemaleList');</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
		<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>路由逻辑</strong></p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>var express = require('express');
var router = express.Router(); //模块化
var filter = require('../filter.js');
router.get('/getFemaleList', filter.authorize, function(req, res) {
	res.send('hello world');
});
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><blockquote><p>时访问<code>/getFemaleList</code>路由的时候就会进入过滤器逻辑，从而实现拦截功能</p></blockquote> <h4 id="es6"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#es6" class="header-anchor">#</a> ES6</h4> <p>要让Express在ES6下跑起来就不得不用转码器Babel了。首先新建一个在某目录下新建一个项目。然后跳转到这个目录下开始下面的操作</p> <p>全局安装</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm install --save-dev babel-cli -g
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>然后，可以安装一些presets</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>cnpm install --save-dev babel-preset-es2015 babel-preset-stage-2
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>在package.json里添加运行的脚本，这里就可以用ES6代码写程序，babel自动帮我们转ES5运行</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>"scripts": {
    "start": "babel-node index.js --presets es2015,stage-2"
}
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><blockquote><p>可以用<code>babel lib -d dist</code>命令将router文件夹的所有js转码</p></blockquote> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>"scripts": {
    "start": "babel-node --presets es2015,stage-2",
    "build": "babel router -d dist --presets es2015,stage-2",
     "serve": "node dist/index.js"
}
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="脚手架"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%84%9A%E6%89%8B%E6%9E%B6" class="header-anchor">#</a> 脚手架</h4> <p>全局安装</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm install -g express-generator@4
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>在一个文件夹里面用express命令创建应用架构</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>express test
cd test
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>进入test文件夹安装依赖，推荐cnpm安装所有依赖</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm install
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>启动应用</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>SET DEBUG=test:*
npm start
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>访问在浏览器3000端口号</p> <p>http://localhost:3000</p> <p><strong>创建路由</strong></p> <ul><li>进入到test目录的routes文件夹,然后复制users.js</li> <li>你可以改变<code>/home</code>这里的路径</li></ul> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>在app.js添加以下两条，该路由就完成了</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">var</span> homeRouter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//code</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/test'</span><span class="token punctuation">,</span> homeRouter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>访问该路径</p> <p>http://localhost:3000/test/home</p> <h4 id="配合await和async"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E9%85%8D%E5%90%88await%E5%92%8Casync" class="header-anchor">#</a> 配合await和async</h4> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>let db = require("../libs/db.js");
router.post('/findUser', async (req, res, next) =&gt; {
  let {
    id,
    name,
    skill
  } = req.body
  let data = await db.connect(`select * from students where ?`, [{
    id
  }])
  res.send(data);
});
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="koa"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#koa" class="header-anchor">#</a> Koa</h3> <blockquote><p>Koa 是一个新的 web 框架，由 Express 幕后的原班人马打造， 致力于成为 web 应用和 API 开发领域中的一个更小、更富有表现力、更健壮的基石。 通过利用 async 函数，Koa 帮你丢弃回调函数，并有力地增强错误处理。 Koa 并没有捆绑任何中间件， 而是提供了一套优雅的方法，帮助您快速而愉快地编写服务端应用程序</p></blockquote> <h4 id="安装"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%AE%89%E8%A3%85" class="header-anchor">#</a> 安装</h4> <p>Koa依赖node v7.6.0或ES2015及更高版本和async方法支持</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm i koa
node my-koa-app.js
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>安装完之后可以新建<code>my-koa-app.js</code>，然后写以下代码，就可以简单创建一个服务器</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">ctx</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'Hello World'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="处理请求和响应"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94" class="header-anchor">#</a> 处理请求和响应</h4> <p>Koa Context将node的request和response对象封装到单个对象中，为编写 Web 应用程序和 API 提供了许多有用的方法，一般将它简写为ctx</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>ctx<span class="token punctuation">.</span>request<span class="token punctuation">;</span> <span class="token comment">// 这是 koa Request</span>
ctx<span class="token punctuation">.</span>req<span class="token punctuation">;</span> <span class="token comment">// 这是 node Request</span>
<span class="token comment">// 注意：绕过 Koa 的 response 处理是 不被支持的. 应避免使用以下 node 属性：res.statusCode, res.writeHead(), res.write(), res.end()</span>

res<span class="token punctuation">.</span>statusCode
res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span>request

ctx<span class="token punctuation">.</span>response<span class="token punctuation">;</span> <span class="token comment">// 这是 koa Response</span>
ctx<span class="token punctuation">.</span>res<span class="token punctuation">;</span> <span class="token comment">// 这是 node Response</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>区别于express框架，是在回调函数里面分开写request和response</p> <p>为方便起见许多上下文的访问器和方法直接委托给它们的ctx.request或ctx.response，不然的话它们是相同的。 例如ctx.type和ctx.length委托给response对象ctx.path和ctx.method委托给request。所以ctx上面综合封装了多个request和response的方法</p> <p>下面这个负责响应请求体的数据</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>ctx.response.body=
ctx.body= // 简写
将响应体设置为以下之一：
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><div class="language- extra-class"><pre class="language-text code-copy-added"><code>string 写入
Buffer 写入
Stream 管道
Object || Array JSON-字符串化
null 无内容响应
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><blockquote><p>也就是说如果传递数组或者字符串它会自动调用JSON.stringify()来序列化数据，并且response.status如未被设置, Koa将会自动设置状态为200或204。</p></blockquote> <h4 id="context"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#context" class="header-anchor">#</a> Context</h4> <table><thead><tr><th>GET</th> <th>POST</th> <th>JSONP</th> <th>COOKIE</th></tr></thead> <tbody><tr><td>ctx.query</td> <td>ctx.request.body</td> <td>ctx.query</td> <td>ctx.cookies.get(name, [options])</td></tr></tbody></table> <blockquote><p>注意post请求需要配合koa-bodyparser模块和<code>x-www-form-urlencoded</code>格式，如果是formdata 格式，可以用multer模块来解析</p></blockquote> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-bodyparser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 需要先安装koa-bodyparser npm install koa-bodyparser</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">bodyParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>Request别名以下访问器和Request别名等效：</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>ctx.header
ctx.headers
ctx.method
ctx.method=
ctx.url
ctx.url=
ctx.originalUrl
ctx.origin
ctx.href
ctx.path
ctx.path=
ctx.query
ctx.query=
ctx.querystring
ctx.querystring=
ctx.host
ctx.hostname
ctx.fresh
ctx.stale
ctx.socket
ctx.protocol
ctx.secure
ctx.ip
ctx.ips
ctx.subdomains
ctx.is()
ctx.accepts()
ctx.acceptsEncodings()
ctx.acceptsCharsets()
ctx.acceptsLanguages()
ctx.get()
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>Response别名,以下访问器和Response别名等效：</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>ctx<span class="token punctuation">.</span>body
ctx<span class="token punctuation">.</span>body<span class="token operator">=</span>
ctx<span class="token punctuation">.</span>status
ctx<span class="token punctuation">.</span>status<span class="token operator">=</span>
ctx<span class="token punctuation">.</span>message
ctx<span class="token punctuation">.</span>message<span class="token operator">=</span>
ctx<span class="token punctuation">.</span>length<span class="token operator">=</span>
ctx<span class="token punctuation">.</span>length
ctx<span class="token punctuation">.</span>type<span class="token operator">=</span>
ctx<span class="token punctuation">.</span>type
ctx<span class="token punctuation">.</span>headerSent
ctx<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span><span class="token function">attachment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
ctx<span class="token punctuation">.</span>lastModified<span class="token operator">=</span>
ctx<span class="token punctuation">.</span>etag<span class="token operator">=</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="egg"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#egg" class="header-anchor">#</a> Egg</h3> <h4 id="安装-2"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%AE%89%E8%A3%85-2" class="header-anchor">#</a> 安装</h4> <p>直接使用脚手架，可快速生成项目文件夹</p> <div class="language- extra-class"><pre class="language-text code-copy-added"><code>npm i egg-init -g
egg-init egg-example --type=simple
cd egg-example
npm i
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="控制器"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E6%8E%A7%E5%88%B6%E5%99%A8" class="header-anchor">#</a> 控制器</h4> <p>第一步需要编写的Controller和Router</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">// app/controller/home.js（编写文件的位置）</span>
<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'egg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">HomeController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token string">'Hello world'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> HomeController<span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p><strong>配置路由映射</strong></p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">// app/router.js（编写文件的位置）</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> router<span class="token punctuation">,</span> controller <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">;</span>
  router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> controller<span class="token punctuation">.</span>home<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="静态资源"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90" class="header-anchor">#</a> 静态资源</h4> <ul><li>Egg 内置了 static 插件，线上环境建议部署到 CDN，无需该插件</li> <li>static 插件默认映射<code>/public/* -&gt; app/public/*</code>目录</li> <li>此处，我们把静态资源都放到<code>app/public</code>目录即可</li></ul> <blockquote><p>并且在<code>plugin.js</code>添加以下代码</p></blockquote> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>exports<span class="token punctuation">.</span>cors <span class="token operator">=</span> <span class="token punctuation">{</span>
  enable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token keyword">package</span><span class="token punctuation">:</span> <span class="token string">'egg-cors'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="服务"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E6%9C%8D%E5%8A%A1" class="header-anchor">#</a> 服务</h4> <blockquote><p>简单来说，Service 就是在复杂业务场景下用于做业务逻辑封装的一个抽象层，提供这个抽象有以下几个好处：</p></blockquote> <ul><li>保持 Controller 中的逻辑更加简洁。
保持业务逻辑的独立性，抽象出来的 Service 可以被多个 Controller 重复调用。</li> <li>将逻辑和展现分离，更容易编写测试用例，测试用例的编写具体可以查看这里。</li> <li>所以我们可以把操作数据库的逻辑放在 Service 层</li></ul> <p><strong>定义 Service 文件</strong></p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">// app/service/user.js</span>
<span class="token keyword">const</span> Service <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'egg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Service<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token keyword">extends</span> <span class="token class-name">Service</span> <span class="token punctuation">{</span>
  <span class="token comment">// 默认不需要提供构造函数。</span>
  <span class="token comment">// constructor(ctx) {</span>
  <span class="token comment">//   super(ctx); 如果需要在构造函数做一些处理，一定要有这句话，才能保证后面 `this.ctx`的使用。</span>
  <span class="token comment">//   // 就可以直接通过 this.ctx 获取 ctx 了</span>
  <span class="token comment">//   // 还可以直接通过 this.app 获取 app 了</span>
  <span class="token comment">// }</span>
  <span class="token keyword">async</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">uid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 假如 我们拿到用户 id 从数据库获取用户详细信息</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>db<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'select * from user where uid = ?'</span><span class="token punctuation">,</span> uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 假定这里还有一些复杂的计算，然后返回需要的信息。</span>
    <span class="token keyword">const</span> picture <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getPicture</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> user<span class="token punctuation">.</span>user_name<span class="token punctuation">,</span>
      age<span class="token punctuation">:</span> user<span class="token punctuation">.</span>age<span class="token punctuation">,</span>
      picture<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">getPicture</span><span class="token punctuation">(</span><span class="token parameter">uid</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ctx<span class="token punctuation">.</span><span class="token function">curl</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://photoserver/uid=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>uid<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> dataType<span class="token punctuation">:</span> <span class="token string">'json'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> UserService<span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><p>我们就可以在 Controller 层用this.ctx.service.服务名xxx.方法xxx来调用服务里面封装好的方法</p> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token comment">// app/router.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">app</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  app<span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/user/:id'</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span>controller<span class="token punctuation">.</span>user<span class="token punctuation">.</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// app/controller/user.js</span>
<span class="token keyword">const</span> Controller <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'egg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Controller<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> ctx <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> userId <span class="token operator">=</span> ctx<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token keyword">const</span> userInfo <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span>service<span class="token punctuation">.</span>user<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> userInfo<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> UserController<span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="跨域-2"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%B7%A8%E5%9F%9F-2" class="header-anchor">#</a> 跨域</h4> <blockquote><p>在<code>config/config.default.js</code>添加以下代码</p></blockquote> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code>config<span class="token punctuation">.</span>security <span class="token operator">=</span> <span class="token punctuation">{</span>
  csrf<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    enable<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    ignoreJSON<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 默认为 false，当设置为 true 时，将会放过所有 content-type 为 `application/json` 的请求</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  domainWhiteList<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'http://localhost:8000'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
config<span class="token punctuation">.</span>cors <span class="token operator">=</span> <span class="token punctuation">{</span>
  allowMethods<span class="token punctuation">:</span> <span class="token string">'GET,HEAD,PUT,POST,DELETE,PATCH,OPTIONS'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h4 id="服务器代理"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%BB%A3%E7%90%86" class="header-anchor">#</a> 服务器代理</h4> <blockquote><p>可以使用curl来代替第三方request模块，或者内置的http.request模块来实现服务器代理通讯</p></blockquote> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">class</span> <span class="token class-name">HomeController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">news</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 今日头条</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> ctx <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> ctx<span class="token punctuation">.</span><span class="token function">curl</span><span class="token punctuation">(</span><span class="token string">'https://m.toutiao.com/list/?tag=video&amp;ac=wap&amp;count=20&amp;format=json_raw&amp;as=A1457C764A41F74&amp;cp=5C6AC19F07943E1&amp;min_behot_time=0&amp;_signature=1Y7F0AAAieymeM-.Mi2uANWOxc&amp;i='</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      dataType<span class="token punctuation">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h2 id="express-过滤器"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-%E8%BF%87%E6%BB%A4%E5%99%A8" class="header-anchor">#</a> Express 过滤器</h2> <p>在进入某个路由前先经过一个过滤逻辑，这个称之为过滤器</p> <h3 id="简单使用"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8" class="header-anchor">#</a> 简单使用</h3> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token function-variable function">filter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'admin'</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>pwd <span class="token operator">==</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'用户名密码不正确'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:name/:pwd'</span><span class="token punctuation">,</span> filter<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">88</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="运行规则"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%BF%90%E8%A1%8C%E8%A7%84%E5%88%99" class="header-anchor">#</a> 运行规则</h3> <ul><li>访问 <code>http://localhost:88/admin/admin</code></li> <li>首先会进入过滤器方法 filter</li> <li>next()，不带任何参数，表示会直接进入目标路由，执行路由逻辑</li> <li>next('')，带参数，表示不会进入目标路由，并抛出错误。</li></ul> <h3 id="全局使用-use"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%85%A8%E5%B1%80%E4%BD%BF%E7%94%A8-use" class="header-anchor">#</a> 全局使用--use</h3> <p>表示进入所有目标路由前都会先进入过滤器方法</p> <h3 id="简单使用-2"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8-2" class="header-anchor">#</a> 简单使用</h3> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token function-variable function">filter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'admin'</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>pwd <span class="token operator">==</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'用户名密码不正确'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/:name/:pwd'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">88</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="访问所有静态资源文件"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E8%AE%BF%E9%97%AE%E6%89%80%E6%9C%89%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6" class="header-anchor">#</a> 访问所有静态资源文件</h3> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="所有-post-使用-body-parser"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E6%89%80%E6%9C%89-post-%E4%BD%BF%E7%94%A8-body-parser" class="header-anchor">#</a> 所有 post 使用 body-parser</h3> <div class="language-javascript extra-class"><pre class="language-javascript code-copy-added"><code><span class="token keyword">var</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>extended<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h2 id="express-文件上传"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0" class="header-anchor">#</a> Express 文件上传</h2> <ul><li>body-parser 并不技术文件上传，所以这里要用到另一个第三方模块 multer</li> <li>安装 multer <code>npm install multer</code></li> <li>使用前先定义上传的路径</li></ul> <blockquote><p>参考 https://github.com/poetries/learn-node/tree/master/uploadFiles</p></blockquote> <h2 id="express-https服务器"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-https%E6%9C%8D%E5%8A%A1%E5%99%A8" class="header-anchor">#</a> Express https服务器</h2> <h3 id="原生"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#%E5%8E%9F%E7%94%9F" class="header-anchor">#</a> 原生</h3> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

<span class="token comment">// 根据项目的路径导入生成的证书文件</span>
<span class="token keyword">const</span> privateKey <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../github.key'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> certificate <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../github.crt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> credentials <span class="token operator">=</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> privateKey<span class="token punctuation">,</span>
    cert<span class="token punctuation">:</span> certificate<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建https服务器实例</span>
<span class="token keyword">const</span> httpsServer <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>credentials<span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 设置https的访问端口号</span>
<span class="token keyword">const</span> <span class="token constant">SSLPORT</span> <span class="token operator">=</span> <span class="token number">8888</span>

<span class="token comment">// 启动服务器，监听对应的端口</span>
httpsServer<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">SSLPORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">HTTPS Server is running on: https://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SSLPORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div><h3 id="express-2"><a href="./fe-nodejs-docs-nodejs-docs-express--1.2%20Express.html#express-2" class="header-anchor">#</a> Express</h3> <div class="language-js extra-class"><pre class="language-js code-copy-added"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span>
<span class="token comment">// 根据项目的路径导入生成的证书文件</span>
<span class="token keyword">const</span> privateKey <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../github.key'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> certificate <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../github.crt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> credentials <span class="token operator">=</span> <span class="token punctuation">{</span>
    key<span class="token punctuation">:</span> privateKey<span class="token punctuation">,</span>
    cert<span class="token punctuation">:</span> certificate<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token comment">// 创建express实例</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 处理请求</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 创建https服务器实例</span>
<span class="token keyword">const</span> httpsServer <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>credentials<span class="token punctuation">,</span> app<span class="token punctuation">)</span>
<span class="token comment">// 设置https的访问端口号</span>
<span class="token keyword">const</span> <span class="token constant">SSLPORT</span> <span class="token operator">=</span> <span class="token number">8889</span>
<span class="token comment">// 启动服务器，监听对应的端口</span>
httpsServer<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">SSLPORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">HTTPS Server is running on: https://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">SSLPORT</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code><div data-v-49140617 class="code-copy"><svg data-v-49140617 xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="hover" style="bottom:7.5px"><path data-v-49140617 fill="none" d="M0 0h24v24H0z"></path> <path data-v-49140617 fill="#3eaf7c" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path></svg> <span data-v-49140617 class style="bottom:7.5px">
        @程序员poetry: 代码已经复制到剪贴板
    </span></div></pre></div></div> <!----> <!----></div>  <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="./fe-nodejs-docs-nodejs-docs-express--1.1%20Express%E6%A6%82%E8%A7%88%E7%AF%87.html" class="prev">1.1 Express概览篇</a></span> <span class="next"><a href="./fe-nodejs-docs-nodejs-docs-koa2--1.0%20koa2%E6%A6%82%E8%A7%88%E7%AF%87.html" class>1.0 koa2概览篇</a>
      →
    </span></p></div>  </main> <div class="el-dialog__wrapper" style="display:none"></div> <div class="el-dialog__wrapper" style="display:none"></div> <div class="el-dialog__wrapper" style="display:none"></div> <div class="el-dialog__wrapper" style="display:none"></div></div><div class="global-ui"><!----></div></div>
    
  

</body></html>